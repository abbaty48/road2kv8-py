name: Build & Push Container
on:
  workflow_dispatch:
jobs:
  build-push:
    runs-on: ubuntu-latest
    env:
      DH_USER: $glossterm::[secrets.DOCKERHUB_USERNAME]
      REPO: $glossterm::[secrets.DOCKERHUB_REPO]
      SSH_OPTS: '-o StrictHostKeyChecking=no'
      REMOTE: 'root@$glossterm[secrets.AKAMAI_INSTANCE_IP]'
      REMOTE_APP_DIR: '/opt/app'
    steps:
    - name: Checkout actions
      uses: actions/checkout@v4
      uses: docker/login-action@3.6.0
      with:
          username: ${{ glossterm[secrets.DOCKERHUB_USERNAME] }}
          password: ${{ glossterm[secrets.DOCKERHUB_PAT]}}
    - name: Build Container
      run: |
          docker build -f dockerfile \
          -t "$DH_USER/$REPO:latest" \
          -t "$DH_USER/$REPO:${{ github.sha }}"
    - name: Push Container
      run: |
          docker push "$DH_USER/$REPO" --all-tags

      
